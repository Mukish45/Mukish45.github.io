<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="A production-ready guide to building efficient, secure, and maintainable Docker containers.">
    <title>Docker Best Practices | Mukish S Blog</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="/styles.css">
    <style>
        .post-header {
            padding-top: 120px;
            padding-bottom: var(--space-3xl);
            text-align: center;
            max-width: 800px;
            margin: 0 auto;
        }

        .post-category {
            display: inline-block;
            padding: var(--space-xs) var(--space-md);
            background: rgba(0, 245, 212, 0.1);
            border: 1px solid rgba(0, 245, 212, 0.2);
            border-radius: var(--radius-full);
            font-size: 0.75rem;
            color: var(--color-accent-cyan);
            margin-bottom: var(--space-lg);
        }

        .post-title {
            font-size: clamp(2rem, 5vw, 3rem);
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: var(--space-lg);
            line-height: 1.2;
        }

        .post-meta {
            display: flex;
            justify-content: center;
            gap: var(--space-xl);
            color: var(--color-text-muted);
            font-size: 0.9rem;
        }

        .post-meta span {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .post-content {
            max-width: 720px;
            margin: 0 auto;
            padding-bottom: var(--space-4xl);
        }

        .post-content h2 {
            font-size: 1.75rem;
            margin-top: var(--space-3xl);
            margin-bottom: var(--space-lg);
            color: var(--color-accent-cyan);
        }

        .post-content h3 {
            font-size: 1.35rem;
            margin-top: var(--space-2xl);
            margin-bottom: var(--space-md);
        }

        .post-content p {
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--color-text-secondary);
            margin-bottom: var(--space-lg);
        }

        .post-content code {
            background: var(--color-bg-tertiary);
            padding: 2px 8px;
            border-radius: var(--radius-sm);
            font-family: 'Fira Code', monospace;
            font-size: 0.9em;
            color: var(--color-accent-magenta);
        }

        .post-content pre {
            background: var(--color-bg-secondary);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-lg);
            padding: var(--space-xl);
            overflow-x: auto;
            margin: var(--space-xl) 0;
        }

        .post-content pre code {
            background: none;
            padding: 0;
            color: var(--color-text-primary);
        }

        .post-content blockquote {
            border-left: 3px solid var(--color-accent-coral);
            padding-left: var(--space-lg);
            margin: var(--space-xl) 0;
            font-style: italic;
            color: var(--color-text-secondary);
        }

        .post-content ul, .post-content ol {
            margin: var(--space-lg) 0;
            padding-left: var(--space-xl);
            color: var(--color-text-secondary);
        }

        .post-content li {
            margin-bottom: var(--space-sm);
            line-height: 1.7;
        }

        .post-content a {
            color: var(--color-accent-cyan);
            text-decoration: underline;
            text-decoration-color: rgba(0, 245, 212, 0.3);
            transition: var(--transition-fast);
        }

        .post-content a:hover {
            text-decoration-color: var(--color-accent-cyan);
        }

        .post-content img {
            max-width: 100%;
            border-radius: var(--radius-lg);
            margin: var(--space-xl) 0;
        }

        .share-section {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-lg);
            padding: var(--space-2xl) 0;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            margin-top: var(--space-3xl);
        }

        .share-label { color: var(--color-text-muted); }

        .share-buttons {
            display: flex;
            gap: var(--space-md);
        }

        .share-btn {
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--color-bg-card);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius-lg);
            color: var(--color-text-secondary);
            transition: var(--transition-fast);
        }

        .share-btn:hover {
            border-color: var(--color-accent-cyan);
            color: var(--color-accent-cyan);
        }

        .share-btn svg { width: 20px; height: 20px; }

        .back-link {
            display: inline-flex;
            align-items: center;
            gap: var(--space-sm);
            color: var(--color-text-secondary);
            margin-bottom: var(--space-xl);
            transition: var(--transition-fast);
        }

        .back-link:hover { color: var(--color-accent-cyan); }

        .author-card {
            display: flex;
            align-items: center;
            gap: var(--space-xl);
            background: var(--color-bg-card);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            margin-top: var(--space-3xl);
        }

        .author-avatar {
            width: 80px;
            height: 80px;
            background: var(--gradient-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            flex-shrink: 0;
        }

        .author-info h4 {
            font-size: 1.25rem;
            margin-bottom: var(--space-xs);
        }

        .author-info p {
            color: var(--color-text-secondary);
            font-size: 0.95rem;
            margin-bottom: var(--space-sm) !important;
        }

        .author-links {
            display: flex;
            gap: var(--space-md);
        }

        .author-links a {
            color: var(--color-text-muted);
            transition: var(--transition-fast);
        }

        .author-links a:hover { color: var(--color-accent-cyan); }
    </style>
</head>
<body>
    <canvas id="neural-canvas"></canvas>

    <!-- Navigation -->
    <nav class="nav" id="nav">
        <div class="nav-container">
            <a href="/" class="nav-logo">
                <span class="logo-bracket">&lt;</span>
                <span class="logo-text">MS</span>
                <span class="logo-bracket">/&gt;</span>
            </a>
            <ul class="nav-links" id="nav-links">
                <li><a href="/#about" class="nav-link">About</a></li>
                <li><a href="/#skills" class="nav-link">Skills</a></li>
                <li><a href="/#projects" class="nav-link">Projects</a></li>
                <li><a href="/blog/" class="nav-link">Blog</a></li>
                <li><a href="/#contact" class="nav-link">Contact</a></li>
            </ul>
            <button class="nav-toggle" id="nav-toggle" aria-label="Toggle navigation">
                <span></span><span></span><span></span>
            </button>
        </div>
    </nav>

    <main class="container">
        <a href="/blog/" class="back-link">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
            Back to Blog
        </a>

        <header class="post-header">
            <span class="post-category">üìù DevOps</span>
            <h1 class="post-title">Docker Best Practices</h1>
            <div class="post-meta">
                <span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="16" y1="2" x2="16" y2="6"></line>
                        <line x1="8" y1="2" x2="8" y2="6"></line>
                        <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                    November 23, 2025
                </span>
                <span>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                    10 min read
                </span>
            </div>
        </header>

        <article class="post-content">
            <h1>Docker Best Practices</h1>
<p><strong>Production-Ready Guide</strong></p>
<hr>
<h2>üèóÔ∏è 1. Efficiency: Building Faster &amp; Smaller</h2>
<p>Optimizing Docker images isn&#39;t just about disk space; it&#39;s about deployment speed and attack surface reduction.</p>
<h3>The Layer Cake Strategy</h3>
<p>Docker caches layers. If a layer changes, all subsequent layers must be rebuilt. The key is to order your commands from least-frequently-changed to most-frequently-changed.</p>
<h4>‚ùå Bad: The Slow Way</h4>
<p>Copying source code first invalidates the cache every time you edit a single file, forcing <code>npm install</code> to re-run needlessly.</p>
<ol>
<li><code>COPY . .</code></li>
<li><code>RUN npm install</code></li>
<li>(Edit app.js)</li>
<li>üí• Cache invalidated</li>
<li>üêå Re-run 1 &amp; 2</li>
</ol>
<h4>‚úÖ Good: The Fast Way</h4>
<p>Copying only <code>package.json</code> first ensures <code>npm install</code> only re-runs when your dependencies <em>actually</em> change.</p>
<ol>
<li><code>COPY package*.json .</code></li>
<li><code>RUN npm install</code></li>
<li><code>COPY . .</code></li>
<li>(Edit app.js)</li>
<li>‚úÖ 1 &amp; 2 are CACHED</li>
<li>üöÄ Only re-run 3</li>
</ol>
<h3>Base Image Strategy</h3>
<p>Choosing the right starting point matters. Avoid generic tags like <code>node:latest</code>. They are huge (1GB+) and change unexpectedly.</p>
<table>
<thead>
<tr>
<th align="left">Image Tag</th>
<th align="left">Size (Approx)</th>
<th align="left">Use Case</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>node:latest</code></td>
<td align="left">~1 GB</td>
<td align="left">Dev only. Contains everything.</td>
</tr>
<tr>
<td align="left"><code>node:18-slim</code></td>
<td align="left">~200 MB</td>
<td align="left">Production. Minimal OS packages.</td>
</tr>
<tr>
<td align="left"><code>node:18-alpine</code></td>
<td align="left">~50 MB</td>
<td align="left">Extreme optimization (Warning: uses musl libc).</td>
</tr>
</tbody></table>
<h3>Multi-Stage Builds</h3>
<p>Don&#39;t ship your build tools (compilers, git, dev dependencies) to production. Use a <strong>Builder</strong> stage to create artifacts, and copy only what you need to a clean, lightweight <strong>Runner</strong> image.</p>
<pre><code class="language-dockerfile"># --- Stage 1: The Builder ---
FROM node:18-alpine AS builder
WORKDIR /app

# 1. Copy dependency definitions first (Cached!)
COPY package*.json .

# 2. Install dependencies (including devDependencies for building)
RUN npm ci

# 3. Copy source code last
COPY . .

# 4. Build the app (if using TypeScript/React etc)
RUN npm run build

# --- Stage 2: The Production Image ---
FROM node:18-alpine
WORKDIR /app

# Copy ONLY the production node_modules and built code
COPY --from=builder /app/node_modules ./node_modules
COPY --from=builder /app/dist ./dist

CMD [&quot;node&quot;, &quot;dist/index.js&quot;]
</code></pre>
<h3>The .dockerignore File</h3>
<p>Always include a <code>.dockerignore</code> file. This prevents local junk (like your node_modules folder, .git history, or .env files) from being sent to the Docker daemon.</p>
<pre><code class="language-dockerfile">node_modules
.git
.env
npm-debug.log
Dockerfile
.dockerignore
</code></pre>
<h3>üõ°Ô∏è 2. Security: Locking It Down</h3>
<p>By default, Docker containers run as root. This is a major security risk.</p>
<h4>The &quot;Root&quot; Problem &amp; Solution</h4>
<p><strong>The Golden Rule:</strong> Always create a dedicated, non-root system user for your application and switch to it using the <code>USER</code> instruction in your Dockerfile.</p>
<h4>The Port Rule &amp; Mapping</h4>
<p>Non-root users cannot bind to &quot;privileged&quot; ports (any port below 1024). The standard practice is:</p>
<ul>
<li>Your application listens on a high port (e.g., 3000) inside the container.</li>
<li>Docker maps a privileged port (e.g., 80) on the outside (host) to your application&#39;s high port.</li>
</ul>
<p><strong>Flow:</strong> <code>INTERNET (User Request Target: Port 80)</code> ‚ûî <code>HOST MACHINE (Docker Daemon -p 80:3000)</code> ‚ûî <code>CONTAINER (Node App USER: appuser PORT: 3000)</code></p>
<h3>Secure Dockerfile Snippet</h3>
<pre><code class="language-dockerfile">FROM node:18-slim

# 1. Create a system group and user (-r flag)
RUN groupadd -r appuser &amp;&amp; useradd -r -g appuser appuser

WORKDIR /app
COPY . .

# 2. Fix permissions so appuser owns the files
RUN chown -R appuser:appuser /app

# 3. Switch context (Drop root privileges)
USER appuser

# 4. Expose high port (internal only)
EXPOSE 3000

CMD [&quot;node&quot;, &quot;index.js&quot;]
</code></pre>
<h3>Secrets: The Anti-Pattern</h3>
<p>‚ö†Ô∏è <strong>Never bake secrets into the image.</strong><br>Do NOT put <code>ENV API_KEY=12345</code> in your Dockerfile. Anyone who pulls the image can see it.</p>
<p>Instead, inject them at runtime:</p>
<pre><code class="language-bash">docker run --env-file .env my-app
</code></pre>
<h3>üèÉ 3. Runtime: Philosophy &amp; Orchestration</h3>
<h4>&quot;One Process Per Container&quot;</h4>
<p>Never bundle your Database and API in the same container. Why? If the API process crashes but the Database process keeps running, Docker will think the container is still healthy.</p>
<ul>
<li><strong>Monolithic Container:</strong> Hard to scale, hard to debug, breaks self-healing. (Container contains API (Crashed) and DB (Running))</li>
<li><strong>Decoupled Containers:</strong> If the API crashes, Docker restarts just that container.</li>
</ul>
<h4>Healthchecks (Self-Healing)</h4>
<p>Docker needs to know if your app is ready to receive traffic. A process can be &quot;running&quot; (PID exists) but &quot;deadlocked&quot; (stuck). Add a healthcheck:</p>
<pre><code class="language-yaml">healthcheck:
  test: [&quot;CMD&quot;, &quot;curl&quot;, &quot;-f&quot;, &quot;http://localhost:3000/health&quot;]
  interval: 30s
  timeout: 10s
  retries: 3
</code></pre>
<h4>Resource Limits (Production Critical)</h4>
<p>Without limits, one memory-leaking container can crash your entire server. Always set limits in your <code>docker-compose.yml</code>.</p>
<pre><code class="language-yaml">version: &#39;3.8&#39;
services:
  api:
    build: .
    deploy:
      resources:
        limits:
          cpus: &#39;0.50&#39;    # Use max 50% of 1 CPU Core
          memory: 512M    # Hard limit
    ports:
      - &quot;80:3000&quot;
    depends_on:
      - db

  db:
    image: mongo:5.0
    volumes:
      - mongo-data:/data/db

volumes:
  mongo-data:
</code></pre>
<h3>‚ö°Ô∏è Cheat Sheet</h3>
<p>Quick reference for the commands used in this guide.</p>
<table>
<thead>
<tr>
<th align="left">Action</th>
<th align="left">Command</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>Build Image</strong></td>
<td align="left"><code>docker build -t my-app .</code></td>
</tr>
<tr>
<td align="left"><strong>Run (Secure Port)</strong></td>
<td align="left"><code>docker run -p 80:3000 my-app</code></td>
</tr>
<tr>
<td align="left"><strong>Run (With Env File)</strong></td>
<td align="left"><code>docker run --env-file .env my-app</code></td>
</tr>
<tr>
<td align="left"><strong>Compose Start (Detach)</strong></td>
<td align="left"><code>docker compose up -d</code></td>
</tr>
<tr>
<td align="left"><strong>Compose Logs</strong></td>
<td align="left"><code>docker compose logs -f</code></td>
</tr>
<tr>
<td align="left"><strong>Check Resource Usage</strong></td>
<td align="left"><code>docker stats</code></td>
</tr>
<tr>
<td align="left"><strong>Clean up Unused</strong></td>
<td align="left"><code>docker system prune -a</code></td>
</tr>
</tbody></table>


            <div class="share-section">
                <span class="share-label">Share this article:</span>
                <div class="share-buttons">
                    <a href="https://twitter.com/intent/tweet?text=Docker%20Best%20Practices&url=" class="share-btn" target="_blank" aria-label="Share on Twitter">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                        </svg>
                    </a>
                    <a href="https://www.linkedin.com/sharing/share-offsite/?url=" class="share-btn" target="_blank" aria-label="Share on LinkedIn">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                        </svg>
                    </a>
                </div>
            </div>

            <div class="author-card">
                <div class="author-avatar">
                    <img src="https://avatars.githubusercontent.com/u/73186875?s=400&u=081c28d78a55b5c18cc1fa2f584e6e3886bd1785&v=4" alt="Author Avatar">
                </div>
                <div class="author-info">
                    <h4>Mukish S</h4>
                    <p>Data Scientist at MangoBytes. Passionate about Machine Learning and Generative AI.</p>
                    <div class="author-links">
                        <a href="https://twitter.com/mukish_s" target="_blank">Twitter</a>
                        <a href="https://github.com/mukish45" target="_blank">GitHub</a>
                        <a href="https://linkedin.com/in/mukish-s2034033" target="_blank">LinkedIn</a>
                    </div>
                </div>
            </div>
        </article>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <p class="footer-text">
                    Designed & Built by <span class="highlight">Mukish S</span> ¬© 2025
                </p>
            </div>
        </div>
    </footer>

    <script src="/script.js"></script>
</body>
</html>